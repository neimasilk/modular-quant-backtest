[WARNING] LLM Sanity Checker not available - running in Adaptive-only mode
================================================================================
HYBRID LLM STRATEGY TEST - NVDA 2023
================================================================================

[1/5] Loading data for NVDA 2023...
      Loaded 250 bars from 2023-01-03 00:00:00 to 2023-12-29 00:00:00

[2/5] Running Adaptive Strategy (baseline)...
/home/user/modular-quant-backtest/test_hybrid_strategy.py:97: UserWarning: Some trades remain open at the end of backtest. Use `Backtest(..., finalize_trades=True)` to close them and include them in stats.
  stats_adaptive = bt_adaptive.run()
      Return: 12.56%
      Sharpe: 0.35
      Max DD: -21.22%
      Trades: 11

[3/5] Running Hybrid Strategy (mock LLM, 70% accuracy)...
/home/user/modular-quant-backtest/test_hybrid_strategy.py:115: UserWarning: Some trades remain open at the end of backtest. Use `Backtest(..., finalize_trades=True)` to close them and include them in stats.
  stats_hybrid_70 = bt_hybrid_70.run(
      Return: 19.89%
      Sharpe: 0.51
      Max DD: -16.15%
      Trades: 12

[4/5] Running Hybrid Strategy (mock LLM, 85% accuracy - optimistic)...
/home/user/modular-quant-backtest/test_hybrid_strategy.py:139: UserWarning: Some trades remain open at the end of backtest. Use `Backtest(..., finalize_trades=True)` to close them and include them in stats.
  stats_hybrid_85 = bt_hybrid_85.run(
      Return: 19.89%
      Sharpe: 0.51
      Max DD: -16.15%
      Trades: 12

[5/5] Running Hybrid Strategy (veto only, no override)...
/home/user/modular-quant-backtest/test_hybrid_strategy.py:163: UserWarning: Some trades remain open at the end of backtest. Use `Backtest(..., finalize_trades=True)` to close them and include them in stats.
  stats_hybrid_veto = bt_hybrid_veto.run(
      Return: 12.62%
      Sharpe: 0.35
      Max DD: -21.21%
      Trades: 11

================================================================================
RESULTS COMPARISON - NVDA 2023
================================================================================

Strategy                  Return     Sharpe     Max DD     Trades     Win Rate  
--------------------------------------------------------------------------------
Adaptive (baseline)        12.56%           0.35          -21.22%         11           54.5%
Hybrid (70% accuracy)      19.89% (+7.3%)   0.51 (+0.17)  -16.15% (-5.1%) 12           58.3%
Hybrid (85% accuracy)      19.89% (+7.3%)   0.51 (+0.17)  -16.15% (-5.1%) 12           58.3%
Hybrid (veto only)         12.62% (+0.1%)   0.35 (+0.00)  -21.21% (-0.0%) 11           54.5%
--------------------------------------------------------------------------------

ðŸ“Š KEY INSIGHTS:
   âœ… Return improved by 7.3% with LLM filter
   âœ… Sharpe ratio improved by 0.17 (47.9%)
   âš ï¸  Drawdown increased by 5.1%

   ðŸ“ˆ Accuracy Impact: 85% vs 70% accuracy improves return by 0.0%
      â†’ This shows LLM accuracy MATTERS - invest in prompt engineering!

================================================================================

ðŸ’¾ Results saved to: experiments/active/EXP-2025-009-hybrid-llm/results/comparison_NVDA_2023.csv

================================================================================

================================================================================
HYBRID LLM STRATEGY TEST - NVDA 2022
================================================================================

[1/5] Loading data for NVDA 2022...
      Loaded 251 bars from 2022-01-03 00:00:00 to 2022-12-30 00:00:00

[2/5] Running Adaptive Strategy (baseline)...
      Return: -23.77%
      Sharpe: -1.03
      Max DD: -37.72%
      Trades: 23

[3/5] Running Hybrid Strategy (mock LLM, 70% accuracy)...
      Return: -21.06%
      Sharpe: -0.90
      Max DD: -36.76%
      Trades: 28

[4/5] Running Hybrid Strategy (mock LLM, 85% accuracy - optimistic)...
      Return: -26.88%
      Sharpe: -1.19
      Max DD: -41.41%
      Trades: 27

[5/5] Running Hybrid Strategy (veto only, no override)...
      Return: -23.77%
      Sharpe: -1.03
      Max DD: -37.72%
      Trades: 23

================================================================================
RESULTS COMPARISON - NVDA 2022
================================================================================

Strategy                  Return     Sharpe     Max DD     Trades     Win Rate  
--------------------------------------------------------------------------------
Adaptive (baseline)       -23.77%          -1.03          -37.72%         23           56.5%
Hybrid (70% accuracy)     -21.06% (+2.7%)  -0.90 (+0.13)  -36.76% (-1.0%) 28           50.0%
Hybrid (85% accuracy)     -26.88% (-3.1%)  -1.19 (-0.17)  -41.41% (+3.7%) 27           55.6%
Hybrid (veto only)        -23.77%          -1.03          -37.72%         23           56.5%
--------------------------------------------------------------------------------

ðŸ“Š KEY INSIGHTS:
   âœ… Return improved by 2.7% with LLM filter
   âœ… Sharpe ratio improved by 0.13 (-12.6%)
   âš ï¸  Drawdown increased by 1.0%

   ðŸ“ˆ Accuracy Impact: 85% vs 70% accuracy improves return by -5.8%
      â†’ This shows LLM accuracy MATTERS - invest in prompt engineering!

================================================================================

ðŸ’¾ Results saved to: experiments/active/EXP-2025-009-hybrid-llm/results/comparison_NVDA_2022.csv

================================================================================


âœ… All tests completed!

Next steps:
  1. Review results in experiments/active/EXP-2025-009-hybrid-llm/results/
  2. If results are promising, proceed to paper trading with real LLM
  3. Fine-tune LLM prompt to achieve >70% accuracy in shadow tests
  4. Document findings in experiments/active/EXP-2025-009-hybrid-llm/README.md
